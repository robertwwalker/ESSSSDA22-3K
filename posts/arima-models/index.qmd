---
title: "Simulation under ARIMA Models"
author: "Robert W. Walker"
date: "08/09/2022"
categories: [time series, code, analysis]
image: "image.jpg"
---

```{r, echo=FALSE}
knitr::opts_chunk$set(echo = TRUE, message=FALSE, warning=FALSE)
```

## ARIMA Models

We want to simulate data under an ARIMA `(p, d, q)` model.  `arima.sim` wants inputs as a list where the expected length of the `ar` and `ma` vectors that will hold the actual values of the `ar` and `ma` parameters.  Here, I ask for a series that is I(1) with a first-order ar=0.1 and a first-order ma=-0.5.  Let me start by generating it and plotting the time series.

```{r}
library(fpp3)
n <- 100
my.data <- data.frame(
  x=arima.sim(n = n, 
              model=list(order = c(1, 1, 1), ar=c(0.7), ma=c(-0.5)), n.start=20), 
  dtime = seq(1,n+1))
library(magrittr)
my.data %<>% as_tsibble(index=dtime) 
my.data %>% autoplot() + labs(title="A (1, 1, 1) Series", x="Time")
```

Now I want to display the ACF and PACF in levels.

```{r}
library(patchwork)
{my.data %>% ACF(x, lag_max=20) %>% 
    autoplot() } + 
  {my.data %>% PACF(x, lag_max=20) %>% 
      autoplot() }
```

Finally, let me display the ACF and PACF with differenced data.

```{r}
{my.data %>% ACF(diff(x), lag_max=20) %>% 
    autoplot() } + 
  {my.data %>% PACF(diff(x), lag_max=20) %>% 
      autoplot() }
```

