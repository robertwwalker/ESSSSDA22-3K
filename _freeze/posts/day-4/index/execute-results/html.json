{
  "hash": "883143d151744b0eb27ff261ec399871",
  "result": {
    "markdown": "---\ntitle: \"Day 4: Cointegration\"\nauthor: \"Robert W. Walker\"\ndate: \"08/11/2022\"\ncategories: [time series, code, analysis]\nimage: \"image.png\"\n---\n\n\n## Slides\n\n- [Slides in .pdf format](./slides/slidesDay4.pdf)\n- [A xaringan for presentation](https://robertwwalker.github.io/xaringan/ESSSSDA22-Day4/)\n\n## A replication\n\nThis is an example with an ECM from a model presented by DeBoef and Keele in their excellent paper \"Taking Time Seriously: Dynamic Regression.\" The data come from a paper Gilmour and Wolbrecht.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(haven); library(tidyverse); library(fpp3)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──\n✔ ggplot2 3.3.6     ✔ purrr   0.3.4\n✔ tibble  3.1.8     ✔ dplyr   1.0.9\n✔ tidyr   1.2.0     ✔ stringr 1.4.0\n✔ readr   2.1.2     ✔ forcats 0.5.1\n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\n── Attaching packages ──────────────────────────────────────────── fpp3 0.4.0 ──\n\n✔ lubridate   1.8.0     ✔ feasts      0.2.2\n✔ tsibble     1.1.1     ✔ fable       0.3.1\n✔ tsibbledata 0.4.0     \n\n── Conflicts ───────────────────────────────────────────────── fpp3_conflicts ──\n✖ lubridate::date()    masks base::date()\n✖ dplyr::filter()      masks stats::filter()\n✖ tsibble::intersect() masks base::intersect()\n✖ tsibble::interval()  masks lubridate::interval()\n✖ dplyr::lag()         masks stats::lag()\n✖ tsibble::setdiff()   masks base::setdiff()\n✖ tsibble::union()     masks base::union()\n```\n:::\n\n```{.r .cell-code}\ndgw.data <- read_stata(\"https://github.com/robertwwalker/Essex-Data/raw/main/dgw.dta\")\ndgw.data <- dgw.data %>% filter(!is.na(year))\ndgw.data <- dgw.data %>% mutate(date = paste0(year,\" Q\",quarter, sep=\"\")) %>% mutate(dateQ = yearquarter(date))\ndgw.ts <- dgw.data %>% as_tsibble(index=dateQ)\n# A dynamic linear model\ndgw.ts %>% model(TSLM(capp~lag(capp,1)+econexp+nytavg+kg+hb+vetoes+override+intrasum+mbills)) %>% report()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSeries: capp \nModel: TSLM \n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-9.1137 -1.3908 -0.1014  1.5446  7.0873 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept)   9.37793    3.33043   2.816  0.00634 ** \nlag(capp, 1)  0.79605    0.05166  15.409  < 2e-16 ***\neconexp       0.07173    0.03090   2.321  0.02323 *  \nnytavg        0.20716    0.06982   2.967  0.00413 ** \nkg           -1.29097    1.08646  -1.188  0.23881    \nhb           -4.68564    1.69975  -2.757  0.00746 ** \nvetoes        0.24382    0.08898   2.740  0.00781 ** \noverride     -0.99198    0.55252  -1.795  0.07697 .  \nintrasum     -0.16907    0.12199  -1.386  0.17021    \nmbills       -0.43939    0.28270  -1.554  0.12469    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2.976 on 69 degrees of freedom\nMultiple R-squared: 0.885,\tAdjusted R-squared: 0.8699\nF-statistic: 58.97 on 9 and 69 DF, p-value: < 2.22e-16\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndgw.ts %>% model(TSLM(capp~lag(capp,1)+p_prap+econexp+nytavg+kg+hb+vetoes+override+intrasum+mbills)) %>% report()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSeries: capp \nModel: TSLM \n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-8.4892 -1.3161 -0.1978  1.7633  6.3624 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  10.13865    3.38461   2.996  0.00382 ** \nlag(capp, 1)  0.77084    0.05585  13.803  < 2e-16 ***\np_prap        0.04708    0.04024   1.170  0.24610    \neconexp       0.08161    0.03195   2.554  0.01290 *  \nnytavg        0.20342    0.06971   2.918  0.00477 ** \nkg           -1.61049    1.11745  -1.441  0.15411    \nhb           -4.87343    1.70280  -2.862  0.00559 ** \nvetoes        0.24012    0.08880   2.704  0.00865 ** \noverride     -0.96229    0.55163  -1.744  0.08560 .  \nintrasum     -0.14809    0.12298  -1.204  0.23267    \nmbills       -0.46652    0.28290  -1.649  0.10375    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2.968 on 68 degrees of freedom\nMultiple R-squared: 0.8872,\tAdjusted R-squared: 0.8706\nF-statistic:  53.5 on 10 and 68 DF, p-value: < 2.22e-16\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndgw.ts %>% model(TSLM(capp~lag(capp, 1)+p_prap+lag(p_prap, 1)+econexp+lag(econexp,1)+nytavg+lag(nytavg, 1)+kg+hb+vetoes+override+intrasum+mbills)) %>% gg_tsresiduals()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 1 row(s) containing missing values (geom_path).\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 1 rows containing missing values (geom_point).\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 1 rows containing non-finite values (stat_bin).\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n\n\n```\nuse \"https://github.com/robertwwalker/Essex-Data/raw/main/dgw.dta\", clear\n* These data have already been time set:\ntsset\n* The dependent variable in this example is Congressional Approval\n*Table 2\nreg capp l.capp econexp nytavg kg hb vetoes override intrasum mbill \nbgodfrey, lag(1 2 3)\n*Table 2 with Pres. Approval\nreg capp l.capp p_prap econexp nytavg kg hb vetoes override intrasum mbill \nbgodfrey, lag(1 2 3)\n* An Alternate Measure\n* ADL\nreg capp l.capp p_prap l.p_prap econexp l.econexp nytavg l.nytavg kg hb vetoes override intrasum mbill \nfitstat\nbgodfrey, lag(1 2 3)\nreg capp l.capp p_prap l.p_prap econexp l.econexp nytavg l.nytavg l2.nytavg kg hb vetoes override intrasum mbill \nfitstat\ntest l.p_prap \n*ECM\nreg d.capp l.capp d.p_prap l.p_prap d.econexp l.econexp d.nytavg l.nytavg kg hb vetoes override intrasum mbill \nbgodfrey, lag(1 2 3)\n*Bewley\nivreg capp p_prap d.p_prap econexp d.econexp nytavg d.nytavg kg hb vetoes override intrasum mbill (d.capp = l.capp p_prap l.p_prap econexp l.econexp nytavg l.nytavg)\n```\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}