{
  "hash": "f66013a440881bd1f031ba58a2ace831",
  "result": {
    "markdown": "---\ntitle: \"Day 4: Cointegration\"\nauthor: \"Robert W. Walker\"\ndate: \"08/11/2022\"\ncategories: [time series, code, analysis]\nimage: \"image.png\"\n---\n\n\n## Slides\n\n- [Slides in .pdf format](./slides/slidesDay4.pdf)\n- [A xaringan for presentation](https://robertwwalker.github.io/xaringan/ESSSSDA22-Day4/)\n\n## A replication\n\nThis is an example with an ECM from a model presented by DeBoef and Keele in their excellent paper \"Taking Time Seriously: Dynamic Regression.\" The data come from a paper Gilmour and Wolbrecht.\n\n```\nuse \"https://github.com/robertwwalker/Essex-Data/raw/main/dgw.dta\", clear\n* These data have already been time set:\ntsset\n* The dependent variable in this example is Congressional Approval\n*Table 2\nreg capp l.capp econexp nytavg kg hb vetoes override intrasum mbill \nbgodfrey, lag(1 2 3)\n```\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(haven); library(tidyverse); library(fpp3)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──\n✔ ggplot2 3.3.6     ✔ purrr   0.3.4\n✔ tibble  3.1.8     ✔ dplyr   1.0.9\n✔ tidyr   1.2.0     ✔ stringr 1.4.0\n✔ readr   2.1.2     ✔ forcats 0.5.1\n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\n── Attaching packages ──────────────────────────────────────────── fpp3 0.4.0 ──\n\n✔ lubridate   1.8.0     ✔ feasts      0.2.2\n✔ tsibble     1.1.1     ✔ fable       0.3.1\n✔ tsibbledata 0.4.0     \n\n── Conflicts ───────────────────────────────────────────────── fpp3_conflicts ──\n✖ lubridate::date()    masks base::date()\n✖ dplyr::filter()      masks stats::filter()\n✖ tsibble::intersect() masks base::intersect()\n✖ tsibble::interval()  masks lubridate::interval()\n✖ dplyr::lag()         masks stats::lag()\n✖ tsibble::setdiff()   masks base::setdiff()\n✖ tsibble::union()     masks base::union()\n```\n:::\n\n```{.r .cell-code}\ndgw.data <- read_stata(\"https://github.com/robertwwalker/Essex-Data/raw/main/dgw.dta\")\ndgw.data <- dgw.data %>% filter(!is.na(year))\ndgw.data <- dgw.data %>% mutate(date = paste0(year,\" Q\",quarter, sep=\"\")) %>% mutate(dateQ = yearquarter(date))\ndgw.ts <- dgw.data %>% as_tsibble(index=dateQ)\n# A dynamic linear model\ndgw.ts %>% model(TSLM(capp~lag(capp,1)+econexp+nytavg+kg+hb+vetoes+override+intrasum+mbills)) %>% report()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSeries: capp \nModel: TSLM \n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-9.1137 -1.3908 -0.1014  1.5446  7.0873 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept)   9.37793    3.33043   2.816  0.00634 ** \nlag(capp, 1)  0.79605    0.05166  15.409  < 2e-16 ***\neconexp       0.07173    0.03090   2.321  0.02323 *  \nnytavg        0.20716    0.06982   2.967  0.00413 ** \nkg           -1.29097    1.08646  -1.188  0.23881    \nhb           -4.68564    1.69975  -2.757  0.00746 ** \nvetoes        0.24382    0.08898   2.740  0.00781 ** \noverride     -0.99198    0.55252  -1.795  0.07697 .  \nintrasum     -0.16907    0.12199  -1.386  0.17021    \nmbills       -0.43939    0.28270  -1.554  0.12469    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2.976 on 69 degrees of freedom\nMultiple R-squared: 0.885,\tAdjusted R-squared: 0.8699\nF-statistic: 58.97 on 9 and 69 DF, p-value: < 2.22e-16\n```\n:::\n:::\n\n\n```\n*Table 2 with Pres. Approval\nreg capp l.capp p_prap econexp nytavg kg hb vetoes override intrasum mbill \nbgodfrey, lag(1 2 3)\n```\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndgw.ts %>% model(TSLM(capp~lag(capp,1)+p_prap+econexp+nytavg+kg+hb+vetoes+override+intrasum+mbills)) %>% report()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSeries: capp \nModel: TSLM \n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-8.4892 -1.3161 -0.1978  1.7633  6.3624 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  10.13865    3.38461   2.996  0.00382 ** \nlag(capp, 1)  0.77084    0.05585  13.803  < 2e-16 ***\np_prap        0.04708    0.04024   1.170  0.24610    \neconexp       0.08161    0.03195   2.554  0.01290 *  \nnytavg        0.20342    0.06971   2.918  0.00477 ** \nkg           -1.61049    1.11745  -1.441  0.15411    \nhb           -4.87343    1.70280  -2.862  0.00559 ** \nvetoes        0.24012    0.08880   2.704  0.00865 ** \noverride     -0.96229    0.55163  -1.744  0.08560 .  \nintrasum     -0.14809    0.12298  -1.204  0.23267    \nmbills       -0.46652    0.28290  -1.649  0.10375    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2.968 on 68 degrees of freedom\nMultiple R-squared: 0.8872,\tAdjusted R-squared: 0.8706\nF-statistic:  53.5 on 10 and 68 DF, p-value: < 2.22e-16\n```\n:::\n:::\n\n\nThe Breusch-Godfrey test\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsapply(c(1:3), function(x) {lmtest::bgtest(lm(capp~lag(capp,1)+p_prap+econexp+nytavg+kg+hb+vetoes+override+intrasum+mbills, data=dgw.ts), order = x)})\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n             [,1]                                                          \nstatistic    0.5038368                                                     \nparameter    1                                                             \nmethod       \"Breusch-Godfrey test for serial correlation of order up to 1\"\np.value      0.4778191                                                     \ndata.name    character,2                                                   \ncoefficients numeric,12                                                    \nvcov         numeric,144                                                   \n             [,2]                                                          \nstatistic    1.043041                                                      \nparameter    2                                                             \nmethod       \"Breusch-Godfrey test for serial correlation of order up to 2\"\np.value      0.5936172                                                     \ndata.name    character,2                                                   \ncoefficients numeric,13                                                    \nvcov         numeric,169                                                   \n             [,3]                                                          \nstatistic    1.531487                                                      \nparameter    3                                                             \nmethod       \"Breusch-Godfrey test for serial correlation of order up to 3\"\np.value      0.6750225                                                     \ndata.name    character,2                                                   \ncoefficients numeric,14                                                    \nvcov         numeric,196                                                   \n```\n:::\n:::\n\n\n```\n* An Alternate Measure\n* ADL\nreg capp l.capp p_prap l.p_prap econexp l.econexp nytavg l.nytavg kg hb vetoes override intrasum mbill \nfitstat\nbgodfrey, lag(1 2 3)\n```\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndgw.ts %>% model(TSLM(capp~lag(capp, 1)+p_prap+lag(p_prap, 1)+econexp+lag(econexp,1)+nytavg+lag(nytavg, 1)+kg+hb+vetoes+override+intrasum+mbills)) %>% gg_tsresiduals()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 1 row(s) containing missing values (geom_path).\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 1 rows containing missing values (geom_point).\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 1 rows containing non-finite values (stat_bin).\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n```\nreg capp l.capp p_prap l.p_prap econexp l.econexp nytavg l.nytavg l2.nytavg kg hb vetoes override intrasum mbill \nfitstat\ntest l.p_prap \n```\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(lm(capp~ dplyr::lag(capp, 1)+p_prap+dplyr::lag(p_prap, 1)+econexp+ dplyr::lag(econexp, 1)+ nytavg+ dplyr::lag(nytavg, 1) + dplyr::lag(nytavg, 2)+ kg+hb+vetoes+override+intrasum+mbills, data=dgw.data))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = capp ~ dplyr::lag(capp, 1) + p_prap + dplyr::lag(p_prap, \n    1) + econexp + dplyr::lag(econexp, 1) + nytavg + dplyr::lag(nytavg, \n    1) + dplyr::lag(nytavg, 2) + kg + hb + vetoes + override + \n    intrasum + mbills, data = dgw.data)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-7.2813 -1.1587 -0.2843  1.5055  5.5623 \n\nCoefficients:\n                        Estimate Std. Error t value Pr(>|t|)    \n(Intercept)            13.255444   4.027775   3.291  0.00164 ** \ndplyr::lag(capp, 1)     0.726775   0.065844  11.038 2.31e-16 ***\np_prap                  0.138223   0.057373   2.409  0.01892 *  \ndplyr::lag(p_prap, 1)  -0.093813   0.055274  -1.697  0.09459 .  \neconexp                 0.005848   0.070969   0.082  0.93459    \ndplyr::lag(econexp, 1)  0.082163   0.072223   1.138  0.25959    \nnytavg                  0.192404   0.071465   2.692  0.00908 ** \ndplyr::lag(nytavg, 1)   0.023006   0.069422   0.331  0.74144    \ndplyr::lag(nytavg, 2)   0.138535   0.078110   1.774  0.08097 .  \nkg                     -1.566093   1.122181  -1.396  0.16774    \nhb                     -4.340598   1.715171  -2.531  0.01389 *  \nvetoes                  0.283759   0.101779   2.788  0.00700 ** \noverride               -1.061008   0.580564  -1.828  0.07235 .  \nintrasum               -0.107917   0.122254  -0.883  0.38074    \nmbills                 -0.715715   0.304646  -2.349  0.02196 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2.914 on 63 degrees of freedom\n  (2 observations deleted due to missingness)\nMultiple R-squared:  0.8992,\tAdjusted R-squared:  0.8768 \nF-statistic: 40.14 on 14 and 63 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nanova(lm(capp~ dplyr::lag(capp, 1)+p_prap+econexp+ dplyr::lag(econexp, 1)+ nytavg+ dplyr::lag(nytavg, 1) + dplyr::lag(nytavg, 2)+ kg+hb+vetoes+override+intrasum+mbills, data=dgw.data), lm(capp~ dplyr::lag(capp, 1)+p_prap+dplyr::lag(p_prap, 1)+econexp+ dplyr::lag(econexp, 1)+ nytavg+ dplyr::lag(nytavg, 1) + dplyr::lag(nytavg, 2)+ kg+hb+vetoes+override+intrasum+mbills, data=dgw.data)) \n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nModel 1: capp ~ dplyr::lag(capp, 1) + p_prap + econexp + dplyr::lag(econexp, \n    1) + nytavg + dplyr::lag(nytavg, 1) + dplyr::lag(nytavg, \n    2) + kg + hb + vetoes + override + intrasum + mbills\nModel 2: capp ~ dplyr::lag(capp, 1) + p_prap + dplyr::lag(p_prap, 1) + \n    econexp + dplyr::lag(econexp, 1) + nytavg + dplyr::lag(nytavg, \n    1) + dplyr::lag(nytavg, 2) + kg + hb + vetoes + override + \n    intrasum + mbills\n  Res.Df    RSS Df Sum of Sq      F  Pr(>F)  \n1     64 559.29                              \n2     63 534.83  1    24.454 2.8806 0.09459 .\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\n```\n*ECM\nreg d.capp l.capp d.p_prap l.p_prap d.econexp l.econexp d.nytavg l.nytavg kg hb vetoes override intrasum mbill \nbgodfrey, lag(1 2 3)\n```\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(lm(difference(capp)~dplyr::lag(capp, 1) + difference(p_prap) +  dplyr::lag(p_prap, 1)+ difference(econexp)+lag(econexp, 1)+difference(nytavg) + dplyr::lag(nytavg) +  kg +  hb +  vetoes + override +  intrasum +  mbills, data=dgw.data))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = difference(capp) ~ dplyr::lag(capp, 1) + difference(p_prap) + \n    dplyr::lag(p_prap, 1) + difference(econexp) + lag(econexp, \n    1) + difference(nytavg) + dplyr::lag(nytavg) + kg + hb + \n    vetoes + override + intrasum + mbills, data = dgw.data)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-8.0575 -1.2991 -0.2338  1.6723  6.0297 \n\nCoefficients:\n                      Estimate Std. Error t value Pr(>|t|)    \n(Intercept)            9.92398    3.59485   2.761 0.007490 ** \ndplyr::lag(capp, 1)   -0.22348    0.05979  -3.738 0.000394 ***\ndifference(p_prap)     0.11480    0.05548   2.069 0.042508 *  \ndplyr::lag(p_prap, 1)  0.02166    0.04356   0.497 0.620667    \ndifference(econexp)    0.02214    0.07027   0.315 0.753732    \nlag(econexp, 1)        0.08156    0.03311   2.463 0.016420 *  \ndifference(nytavg)     0.18074    0.07179   2.518 0.014290 *  \ndplyr::lag(nytavg)     0.22229    0.09152   2.429 0.017921 *  \nkg                    -1.36022    1.12380  -1.210 0.230519    \nhb                    -4.24191    1.72938  -2.453 0.016865 *  \nvetoes                 0.20605    0.09261   2.225 0.029567 *  \noverride              -0.75686    0.55956  -1.353 0.180870    \nintrasum              -0.12549    0.12277  -1.022 0.310504    \nmbills                -0.53209    0.28906  -1.841 0.070217 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2.939 on 65 degrees of freedom\n  (1 observation deleted due to missingness)\nMultiple R-squared:  0.4115,\tAdjusted R-squared:  0.2938 \nF-statistic: 3.496 on 13 and 65 DF,  p-value: 0.0003862\n```\n:::\n:::\n\n\n\n```\n*Bewley\nivreg capp p_prap d.p_prap econexp d.econexp nytavg d.nytavg kg hb vetoes override intrasum mbill (d.capp = l.capp p_prap l.p_prap econexp l.econexp nytavg l.nytavg)\n```\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}